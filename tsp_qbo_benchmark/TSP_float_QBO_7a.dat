N = 7;
Q = [[[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         2.51264062 2.23229672 4.83822074 7.08217922 2.14895027
    9.5248397 ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [2.51264062 0.         3.46311847 0.20878036 3.44876129 9.3432941
    9.77005151]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [2.23229672 3.46311847 0.         4.38865507 6.42941919 9.85965481
    5.73227808]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [4.83822074 0.20878036 4.38865507 0.         8.25659796 6.29722278
    4.05453752]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [7.08217922 3.44876129 6.42941919 8.25659796 0.         4.19894527
    1.08475122]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [2.14895027 9.3432941  9.85965481 6.29722278 4.19894527 0.
    3.16961662]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [9.5248397  9.77005151 5.73227808 4.05453752 1.08475122 3.16961662
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         2.51264062 2.23229672 4.83822074 7.08217922 2.14895027
    9.5248397 ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.51264062 0.         3.46311847 0.20878036 3.44876129 9.3432941
    9.77005151]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.23229672 3.46311847 0.         4.38865507 6.42941919 9.85965481
    5.73227808]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [4.83822074 0.20878036 4.38865507 0.         8.25659796 6.29722278
    4.05453752]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [7.08217922 3.44876129 6.42941919 8.25659796 0.         4.19894527
    1.08475122]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.14895027 9.3432941  9.85965481 6.29722278 4.19894527 0.
    3.16961662]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.5248397  9.77005151 5.73227808 4.05453752 1.08475122 3.16961662
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         2.51264062 2.23229672 4.83822074 7.08217922 2.14895027
    9.5248397 ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.51264062 0.         3.46311847 0.20878036 3.44876129 9.3432941
    9.77005151]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.23229672 3.46311847 0.         4.38865507 6.42941919 9.85965481
    5.73227808]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [4.83822074 0.20878036 4.38865507 0.         8.25659796 6.29722278
    4.05453752]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [7.08217922 3.44876129 6.42941919 8.25659796 0.         4.19894527
    1.08475122]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.14895027 9.3432941  9.85965481 6.29722278 4.19894527 0.
    3.16961662]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.5248397  9.77005151 5.73227808 4.05453752 1.08475122 3.16961662
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         2.51264062 2.23229672 4.83822074 7.08217922 2.14895027
    9.5248397 ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.51264062 0.         3.46311847 0.20878036 3.44876129 9.3432941
    9.77005151]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.23229672 3.46311847 0.         4.38865507 6.42941919 9.85965481
    5.73227808]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [4.83822074 0.20878036 4.38865507 0.         8.25659796 6.29722278
    4.05453752]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [7.08217922 3.44876129 6.42941919 8.25659796 0.         4.19894527
    1.08475122]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.14895027 9.3432941  9.85965481 6.29722278 4.19894527 0.
    3.16961662]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.5248397  9.77005151 5.73227808 4.05453752 1.08475122 3.16961662
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         2.51264062 2.23229672 4.83822074 7.08217922 2.14895027
    9.5248397 ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.51264062 0.         3.46311847 0.20878036 3.44876129 9.3432941
    9.77005151]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.23229672 3.46311847 0.         4.38865507 6.42941919 9.85965481
    5.73227808]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [4.83822074 0.20878036 4.38865507 0.         8.25659796 6.29722278
    4.05453752]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [7.08217922 3.44876129 6.42941919 8.25659796 0.         4.19894527
    1.08475122]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.14895027 9.3432941  9.85965481 6.29722278 4.19894527 0.
    3.16961662]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.5248397  9.77005151 5.73227808 4.05453752 1.08475122 3.16961662
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         2.51264062 2.23229672 4.83822074 7.08217922 2.14895027
    9.5248397 ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.51264062 0.         3.46311847 0.20878036 3.44876129 9.3432941
    9.77005151]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.23229672 3.46311847 0.         4.38865507 6.42941919 9.85965481
    5.73227808]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [4.83822074 0.20878036 4.38865507 0.         8.25659796 6.29722278
    4.05453752]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [7.08217922 3.44876129 6.42941919 8.25659796 0.         4.19894527
    1.08475122]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [2.14895027 9.3432941  9.85965481 6.29722278 4.19894527 0.
    3.16961662]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.5248397  9.77005151 5.73227808 4.05453752 1.08475122 3.16961662
    0.        ]]]


 [[[0.         2.51264062 2.23229672 4.83822074 7.08217922 2.14895027
    9.5248397 ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[2.51264062 0.         3.46311847 0.20878036 3.44876129 9.3432941
    9.77005151]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[2.23229672 3.46311847 0.         4.38865507 6.42941919 9.85965481
    5.73227808]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[4.83822074 0.20878036 4.38865507 0.         8.25659796 6.29722278
    4.05453752]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[7.08217922 3.44876129 6.42941919 8.25659796 0.         4.19894527
    1.08475122]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[2.14895027 9.3432941  9.85965481 6.29722278 4.19894527 0.
    3.16961662]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[9.5248397  9.77005151 5.73227808 4.05453752 1.08475122 3.16961662
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]];
// The indices of the 4-tensor Q are (time,node, time,node). It is to be contracted with boolean variables x with indices (time,node) that are constrained to be orthogonal. One should also fix a starting point, e.g. x(1,1)=1. To unfold it and write everything in standard matrix formulation, use np.reshape(Q,(N**2,N**2) and np.reshape(x,N**2).
N = 7;
Q = [[[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.534344   8.17198149 8.30939398 5.34511    9.81174727
    5.86209422]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.534344   0.         3.08464404 5.47109009 8.80891723 3.54930603
    2.31301076]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [8.17198149 3.08464404 0.         2.3423417  6.53904738 1.45489268
    6.76810289]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [8.30939398 5.47109009 2.3423417  0.         9.81945767 9.8607883
    3.35723266]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [5.34511    8.80891723 6.53904738 9.81945767 0.         5.0819046
    7.88005124]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [9.81174727 3.54930603 1.45489268 9.8607883  5.0819046  0.
    6.10524362]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [5.86209422 2.31301076 6.76810289 3.35723266 7.88005124 6.10524362
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.534344   8.17198149 8.30939398 5.34511    9.81174727
    5.86209422]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.534344   0.         3.08464404 5.47109009 8.80891723 3.54930603
    2.31301076]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.17198149 3.08464404 0.         2.3423417  6.53904738 1.45489268
    6.76810289]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.30939398 5.47109009 2.3423417  0.         9.81945767 9.8607883
    3.35723266]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.34511    8.80891723 6.53904738 9.81945767 0.         5.0819046
    7.88005124]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.81174727 3.54930603 1.45489268 9.8607883  5.0819046  0.
    6.10524362]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.86209422 2.31301076 6.76810289 3.35723266 7.88005124 6.10524362
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.534344   8.17198149 8.30939398 5.34511    9.81174727
    5.86209422]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.534344   0.         3.08464404 5.47109009 8.80891723 3.54930603
    2.31301076]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.17198149 3.08464404 0.         2.3423417  6.53904738 1.45489268
    6.76810289]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.30939398 5.47109009 2.3423417  0.         9.81945767 9.8607883
    3.35723266]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.34511    8.80891723 6.53904738 9.81945767 0.         5.0819046
    7.88005124]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.81174727 3.54930603 1.45489268 9.8607883  5.0819046  0.
    6.10524362]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.86209422 2.31301076 6.76810289 3.35723266 7.88005124 6.10524362
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.534344   8.17198149 8.30939398 5.34511    9.81174727
    5.86209422]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.534344   0.         3.08464404 5.47109009 8.80891723 3.54930603
    2.31301076]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.17198149 3.08464404 0.         2.3423417  6.53904738 1.45489268
    6.76810289]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.30939398 5.47109009 2.3423417  0.         9.81945767 9.8607883
    3.35723266]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.34511    8.80891723 6.53904738 9.81945767 0.         5.0819046
    7.88005124]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.81174727 3.54930603 1.45489268 9.8607883  5.0819046  0.
    6.10524362]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.86209422 2.31301076 6.76810289 3.35723266 7.88005124 6.10524362
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.534344   8.17198149 8.30939398 5.34511    9.81174727
    5.86209422]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.534344   0.         3.08464404 5.47109009 8.80891723 3.54930603
    2.31301076]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.17198149 3.08464404 0.         2.3423417  6.53904738 1.45489268
    6.76810289]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.30939398 5.47109009 2.3423417  0.         9.81945767 9.8607883
    3.35723266]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.34511    8.80891723 6.53904738 9.81945767 0.         5.0819046
    7.88005124]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.81174727 3.54930603 1.45489268 9.8607883  5.0819046  0.
    6.10524362]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.86209422 2.31301076 6.76810289 3.35723266 7.88005124 6.10524362
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]


 [[[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.534344   8.17198149 8.30939398 5.34511    9.81174727
    5.86209422]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.534344   0.         3.08464404 5.47109009 8.80891723 3.54930603
    2.31301076]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.17198149 3.08464404 0.         2.3423417  6.53904738 1.45489268
    6.76810289]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [8.30939398 5.47109009 2.3423417  0.         9.81945767 9.8607883
    3.35723266]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.34511    8.80891723 6.53904738 9.81945767 0.         5.0819046
    7.88005124]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [9.81174727 3.54930603 1.45489268 9.8607883  5.0819046  0.
    6.10524362]]

  [[0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [5.86209422 2.31301076 6.76810289 3.35723266 7.88005124 6.10524362
    0.        ]]]


 [[[0.         0.534344   8.17198149 8.30939398 5.34511    9.81174727
    5.86209422]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[0.534344   0.         3.08464404 5.47109009 8.80891723 3.54930603
    2.31301076]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[8.17198149 3.08464404 0.         2.3423417  6.53904738 1.45489268
    6.76810289]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[8.30939398 5.47109009 2.3423417  0.         9.81945767 9.8607883
    3.35723266]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[5.34511    8.80891723 6.53904738 9.81945767 0.         5.0819046
    7.88005124]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[9.81174727 3.54930603 1.45489268 9.8607883  5.0819046  0.
    6.10524362]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]

  [[5.86209422 2.31301076 6.76810289 3.35723266 7.88005124 6.10524362
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]
   [0.         0.         0.         0.         0.         0.
    0.        ]]]];
// The indices of the 4-tensor Q are (time,node, time,node). It is to be contracted with boolean variables x with indices (time,node) that are constrained to be orthogonal. One should also fix a starting point, e.g. x(1,1)=1. To unfold it and write everything in standard matrix formulation, use np.reshape(Q,(N**2,N**2) and np.reshape(x,N**2).